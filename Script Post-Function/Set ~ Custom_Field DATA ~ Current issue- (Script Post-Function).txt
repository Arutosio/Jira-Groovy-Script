//M1 WORK
import com.atlassian.jira.component.ComponentAccessor;
import com.atlassian.jira.issue.Issue;
import java.sql.Timestamp;

def currentUser = ComponentAccessor.getJiraAuthenticationContext().getLoggedInUser();
def cfSUP = ComponentAccessor.getCustomFieldManager()?.getCustomFieldObjectByName("Single User Picker");
def cfDTP = ComponentAccessor.getCustomFieldManager()?.getCustomFieldObjectByName("Date Time Field");
issue.setCustomFieldValue(cfSUP,currentUser);
issue.setCustomFieldValue(cfDTP, new Timestamp((new Date()).time));



//M2 NOT Work
import com.atlassian.jira.component.ComponentAccessor;
import com.atlassian.jira.issue.ModifiedValue
import com.atlassian.jira.issue.util.DefaultIssueChangeHolder

def currentUser = ComponentAccessor.getJiraAuthenticationContext().getLoggedInUser();
def cfSUP = ComponentAccessor.getCustomFieldManager()?.getCustomFieldObjectByName("Single User Picker");
def cfDTP = ComponentAccessor.getCustomFieldManager()?.getCustomFieldObjectByName("Date Time Field");
issue.setCustomFieldValue(cfSUP,currentUser);
cfDTP.updateValue(null, issue, new ModifiedValue(issue.getCustomFieldValue(cfDTP), new Date()), new DefaultIssueChangeHolder());